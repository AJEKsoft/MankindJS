<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,
				   user-scalable=no,
				   maximum-scale=1.0,
				   minimum-scale=1.0">
    <title>MankindJS</title>
    
    <link rel="stylesheet" href="res/index.css">

    <!-- Shaders. -->
    <script type="x-shader/x-vertex" id="default.vs">
      #version 300 es

      in ivec3 position;
      in uint color;

      out vec4 vcolor;

      uniform mat4 model, view, projection;
      uniform vec3 eye;

      const float pointsize = 1000.0;
      // Should be an uniform, I think.
      const int chunksize = 16;
      
      void main ()
      {
	  ivec3 pos = position;
	  pos.x += gl_InstanceID / (chunksize * chunksize);
	  pos.y += (gl_InstanceID / chunksize) % chunksize;
	  pos.z += gl_InstanceID % chunksize;	  
	  
	  gl_Position = projection * view * model * vec4(pos, 1.0);
	  gl_PointSize = pointsize;

	  // Calculate the color.
	  float r = float ((color >> 0) & uint (0x7)) / 7.0;
	  float g = float ((color >> 3) & uint (0x7)) / 7.0;
	  float b = float ((color >> 6) & uint (0x3)) / 3.0;

	  vcolor = vec4 (r, g, b, 1.0);
      }
    </script>
    
    <script type="x-shader/x-fragment" id="default.fs">
      #version 300 es

      precision mediump float;

      in vec4 vcolor;
      
      out vec4 color;

      void main ()
      {
	  color = vcolor;
      }
    </script>
    
    <!-- Code. -->
    <script type="text/javascript" src="src/utilities.js"></script>
    <script type="text/javascript" src="src/chunk.js"></script>
    <script type="text/javascript" src="src/camera.js"></script>
    <script type="text/javascript" src="src/mesh.js"></script>
    <script type="text/javascript" src="src/program.js"></script>
    <script type="text/javascript" src="src/index.js"></script>
  </head>

  <body>
    <canvas id="canvas"></canvas>
  </body>
</html>
